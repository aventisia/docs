import { Callout, Steps } from "nextra/components";

# Retrieve Exchange Email Messages

The **Retrieve Exchange Email Messages** node allows you to access and process your emails from an Exchange server. You can retrieve emails from personal or shared mailboxes based on various criteria, filter specific messages, and decide how to handle attachments. This is useful for automating email workflows, managing inbox content, and integrating email data with other applications.

{/* ![Retrieve Exchange Email Messages](./retrieve-exchange-email-messages.png) */}

## Configuration Options

| Field Name                                     | Description                                                                                                   | Input Type | Required? | Default Value |
| ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------- | ---------- | --------- | ------------- |
| **Exchange Connection**                        | The Exchange service object representing the connection to the Exchange server.                               | Text       | Yes       | _(empty)_     |
| **Mailbox Type**                               | Specifies whether the mailbox is personal or shared.                                                          | Select     | Yes       | _(empty)_     |
| **Shared Mailbox Address**                     | The email address of the shared mailbox (required if Mailbox Type is 'Shared').                               | Text       | No        | _(empty)_     |
| **Retrieve Email Messages from Custom Folder** | If true, retrieves emails from a custom folder instead of predefined folders.                                 | Switch     | No        | _(empty)_     |
| **Exchange Folder**                            | The folder to retrieve emails from (e.g., Inbox, Sent Items). Appears if not retrieving from a custom folder. | Select     | No        | _(empty)_     |
| **Mail Folder**                                | The name of the custom folder to retrieve emails from, if retrieving from a custom folder.                    | Text       | No        | _(empty)_     |
| **Retrieve**                                   | Specifies which emails to retrieve (e.g., All, Unread, Read).                                                 | Select     | No        | _(empty)_     |
| **Mark as Read**                               | If true, marks retrieved emails as read.                                                                      | Switch     | No        | _(empty)_     |
| **From Contains**                              | Filters emails where the sender's address contains this text.                                                 | Text       | No        | _(empty)_     |
| **To Contains**                                | Filters emails where the recipient's address contains this text.                                              | Text       | No        | _(empty)_     |
| **Subject Contains**                           | Filters emails where the subject contains this text.                                                          | Text       | No        | _(empty)_     |
| **Body Contains**                              | Filters emails where the body contains this text.                                                             | Text       | No        | _(empty)_     |
| **Attachments**                                | Specifies how to handle attachments.                                                                          | Select     | No        | _(empty)_     |
| **Save Attachments Into**                      | The directory to save attachments. Required if Attachments is set to 'Save Attachments'.                      | Text       | No        | _(empty)_     |

## Expected Output Format

The output of this node is a **list of email messages**, referred to as **Retrieved Emails**. This output can be further processed or integrated with other nodes and systems.

- **Retrieved Emails** will be a list containing the retrieved email details based on the configuration and filters set.

## Step-by-Step Guide

<Steps>
### Step 1

Add the **Retrieve Exchange Email Messages** node to your flow.

### Step 2

In the **Exchange Connection** field, enter the connection information for your Exchange server.

### Step 3

Select the **Mailbox Type**:

- **Personal**: For your personal mailbox.
- **Shared**: For a shared mailbox. You will need to provide the **Shared Mailbox Address**.

### Step 4

Decide if you want to retrieve emails from a **Custom Folder**. If yes, enable the corresponding switch and specify the **Mail Folder** name. Otherwise, select the desired folder from the **Exchange Folder** list.

### Step 5

Set the **Retrieve** option to determine which emails to access (All, Unread, or Read).

### Step 6

Choose if emails should be marked as read by toggling the **Mark as Read** switch.

### Step 7

Use the filter options **From Contains**, **To Contains**, **Subject Contains**, and **Body Contains** to specify criteria for filtering emails.

### Step 8

Select the **Attachments** handling method. If saving attachments, specify the directory in **Save Attachments Into**.

### Step 9

The retrieved emails will be available as **Retrieved Emails** for further use in your automation, identified as `RetrievedEmails`.

</Steps>

<Callout type="important" title="Note">
  If you choose to retrieve from a custom folder, ensure that the folder name is
  correct to avoid retrieval errors.
</Callout>

## Input/Output Examples

| Mailbox Type | Retrieve                   | Filters (Subject) | Output Value    | Output Type           |
| ------------ | -------------------------- | ----------------- | --------------- | --------------------- |
| Personal     | All email messages         | blank             | RetrievedEmails | List of Emails        |
| Shared       | Unread email messages only | "Important"       | RetrievedEmails | List of Unread Emails |

## Common Mistakes & Troubleshooting

| Problem                         | Solution                                                                                                     |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| **Connection failure**          | Verify the **Exchange Connection** details and check server accessibility.                                   |
| **Emails not retrieving**       | Ensure correct **Mailbox Type** and folder selections (custom or predefined). Also, check filter conditions. |
| **Attachment directory issues** | Ensure that the directory specified for attachments exists and has write permissions if saving attachments.  |

## Real-World Use Cases

- **Customer Support**: Automate retrieval of unread support emails to ensure timely responses.
- **Team Collaboration**: Fetch emails from a shared mailbox to consolidate communication in team projects.
- **Data Collection**: Automatically retrieve emails with specific criteria for data gathering and analysis workflows.
