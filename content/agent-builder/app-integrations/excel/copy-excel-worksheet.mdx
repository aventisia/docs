import { Callout, Steps } from "nextra/components";

# Copy Excel Worksheet

The **Copy Excel Worksheet** node makes it simple to duplicate a worksheet from one Excel workbook to another within an automated process. This is useful when copying template sheets, consolidating data from multiple sources, or simply transferring sheets between workbooks for further processing.

For example:

- Copying a template worksheet to start a new workbook.
- Consolidating several sections of data by transferring sheets across workbooks.
- Sharing specific worksheet data without sharing the entire workbook.

{/* ![Copy Excel Worksheet](./copy-excel-worksheet.png) */}

## Configuration Options

| Field Name                   | Description                                                              | Input Type | Required? | Default Value  |
| ---------------------------- | ------------------------------------------------------------------------ | ---------- | --------- | -------------- |
| **Source Excel Application** | The Excel Application object containing the source worksheet.            | Text       | Yes       | _(empty)_      |
| **Copy Mode**                | Specifies how to identify the source worksheet: by Name or Index.        | Select     | Yes       | Name           |
| **Worksheet Name**           | The name of the worksheet to copy (required if 'Copy Mode' is 'Name').   | Text       | No        | _(empty)_      |
| **Worksheet Index**          | The index of the worksheet to copy (required if 'Copy Mode' is 'Index'). | Text       | No        | _(empty)_      |
| **Target Excel Application** | The Excel Application object where the worksheet will be copied.         | Text       | Yes       | _(empty)_      |
| **Paste Position**           | Specifies where to paste the copied worksheet in the target workbook.    | Select     | No        | FirstWorksheet |

## Expected Output Format

This node does not directly produce an output value but results in a worksheet being moved from the source to the target workbook within the Excel Application objects specified.

## Step-by-Step Guide

<Steps>
### Step 1

Add the **Copy Excel Worksheet** node into your flow.

### Step 2

Enter or select the **Source Excel Application** that contains the worksheet you want to copy.

### Step 3

Choose the **Copy Mode** from the dropdown:

- **Name**: You need to provide the worksheet's name in the **Worksheet Name** field.
- **Index**: You need to provide the worksheet's index number in the **Worksheet Index** field.

### Step 4

Write the name of the worksheet in **Worksheet Name**, or its index in **Worksheet Index**, based on the chosen Copy Mode.

### Step 5

Enter or select the **Target Excel Application** to which you want to copy the worksheet.

### Step 6

Optionally, choose the **Paste Position** for the worksheet:

- **First worksheet**: Inserts as the first sheet.
- **Last worksheet**: Inserts as the last sheet.

After configuration, your worksheet will be duplicated into the specified target workbook.

</Steps>

<Callout type="info" title="Note">
  Ensure the Excel Application objects (source and target) are properly set up
  before running the flow, or the process will fail.
</Callout>

## Common Mistakes & Troubleshooting

| Problem                                              | Solution                                                                                               |
| ---------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| **Missing Worksheet Name or Index**                  | Ensure you have entered a valid name or index number based on your selected **Copy Mode**.             |
| **Incorrect Source or Target Excel Application**     | Double-check that you've specified the correct Excel objects for both source and target applications.  |
| **Worksheet not appearing in the expected position** | Verify the **Paste Position** setting to ensure it matches your intended order in the target workbook. |

## Real-World Use Cases

- **Template Replication**: Copy and use standard worksheets as templates across multiple projects or workbooks.
- **Data Migration**: Move data sheets to new Excel applications for consolidation or reporting.
- **Workbook Preparation**: Prepopulate specific workbooks with worksheets necessary before distribution.
