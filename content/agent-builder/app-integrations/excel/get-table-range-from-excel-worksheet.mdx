import { Callout, Steps } from "nextra/components";

# Get Table Range from Excel Worksheet

The **Get Table Range from Excel Worksheet** node is used to identify and extract the cell range of a specific table or pivot table within a spreadsheet. This is particularly useful when you need to manipulate, analyze, or perform actions on specific parts of an Excel sheet. By identifying the range, you can ensure that operations are only performed on the selected data, thereby improving data handling efficiency in your processes.

{/* ![Get Table Range from Excel Worksheet](./get-table-range-from-excel-worksheet.png) */}

## Configuration Options

| Field Name            | Description                                                                  | Input Type | Required? | Default Value |
| --------------------- | ---------------------------------------------------------------------------- | ---------- | --------- | ------------- |
| **Excel Application** | The Excel Application object containing the target worksheet.                | Text       | Yes       | _(empty)_     |
| **Table Name**        | The name of the table (ListObject) or pivot table to retrieve the range for. | Text       | Yes       | _(empty)_     |
| **Is Pivot Table**    | If true, retrieves the range of a pivot table instead of a regular table.    | Switch     | No        | _(empty)_     |

## Expected Output Format

The output of this node provides the indices of the table's range in the Excel sheet. The data will be a series of indices representing the first and last rows and columns:

- **First Column Index**: Numeric value indicating the first column's position.
- **First Row Index**: Numeric value indicating the first row's position.
- **Last Column Index**: Numeric value indicating the last column's position.
- **Last Row Index**: Numeric value indicating the last row's position.

## Step-by-Step Guide

<Steps>

### Step 1

Add the **Get Table Range from Excel Worksheet** node into your flow.

### Step 2

In the **Excel Application** field, enter the reference or identifier for the Excel instance containing your desired worksheet.

### Step 3

In the **Table Name** field, specify the name of the table or pivot table whose range you wish to retrieve. Ensure the name matches exactly as it appears in Excel.

### Step 4

If you're targeting a pivot table, toggle the **Is Pivot Table** switch to `true`. Leave it `off` if it's a regular table.

### Step 5

Once configured, the node will output the indices as defined in the description, making the range ready for further actions or analysis in your workflow.

</Steps>

<Callout type="info" title="Note">
  Be careful to enter the exact table or pivot table name to avoid errors in
  retrieving the range.
</Callout>

## Input/Output Examples

| Case          | Input Excel Application | Table Name  | Is Pivot Table | Output Values                                                                |
| ------------- | ----------------------- | ----------- | -------------- | ---------------------------------------------------------------------------- |
| Regular Table | `ExcelApp1`             | `SalesData` | `false`        | FirstColumnIndex: 1, FirstRowIndex: 1, LastColumnIndex: 5, LastRowIndex: 100 |
| Pivot Table   | `ExcelApp2`             | `SummaryPT` | `true`         | FirstColumnIndex: 1, FirstRowIndex: 10, LastColumnIndex: 4, LastRowIndex: 55 |

## Common Mistakes & Troubleshooting

| Problem                     | Solution                                                                                                                        |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| **Table not found**         | Verify that the table name is correctly spelled and corresponds with the name used within the Excel sheet.                      |
| **Empty output values**     | Ensure that the Excel Application and Table Name fields have been filled out correctly and match your worksheet configurations. |
| **Incorrect range indices** | Confirm the table name and check if it is indeed a pivot table or not, as this setting affects how Excel identifies the table.  |

## Real-World Use Cases

- **Report Generation**: Use the identified range to generate reports from specific sections of data in a worksheet.
- **Data Cleaning**: Precisely target and clean up specific table ranges without affecting other data.
- **Excel Automation**: Streamline tasks by automatically determining the range of data to process, minimizing errors in selection.
